{% extends "base.html" %}

{% block content %}

<h2>All your damn Things</h2>

<div id="motive-list" class="list-group">
{% for motive in motive_list %}
    {% set period = motive.latest_period %}
    <div class="list-group-item clearfix">
        <div class="clearfix">
            <div class="pull-left">
                <h4 class="list-group-item-heading">
                    <a href="{{ motive.get_detail_url() }}">
                        <span>You're trying to {{ motive.thing.get_behavior_display() }} {{motive.thing.verb}} {{ motive.thing.name }}</span>
                    </a>
                </h4>
                {% if period %}
                <div class="list-group-item-text">
                    {# TODO: change verbiage based on behavior #}
                    <p>Over the next {{ period.days_left }} days you can do this {{ period.incidents_left}} times.</p>
                    {# TOOD: diff of days to go, humanize the time #}
                </div>
                {% endif %}
            </div>
            <div class="pull-right">
                <form action="{{ url('things:motive_incident', motive.pk) }}" method="post">
                    {{ csrf() }}
                    <button type="submit" class="btn btn-default">I just did this.</button>
                </form>
            </div>
        </div>
    {% if period and not period.past_today %}
        {% set progress_bars = period.progress_bars %}
        {{ proger}}
        <div class="progress">
            {% for bar in progress_bars %}
                <div class="progress-bar progress-bar-{{ bar.type }}" style="width: {{ bar.percent }}%;">{{ bar.text|default('') }}</div>
            {% endfor %}
        </div>
        <div class="progress-indicators">
            {% for bar in progress_bars %}
                <div class="progress-bar-indicator" style="width: {{ bar.percent }}%;">{{ bar.indi|default('&nbsp;')|safe }}</div>
            {% endfor %}
        </div>
    {% endif %}
    </div>
{% else %}
    <div class="list-group-item">
        <h4>You don't have any things! <a href="{{ url('things:create_motive') }}" class="btn btn-primary">Create a Thing!</a></h4>
    </div>
{% endfor %}
</div>
{% if motive_list.exists() %}
    <a href="{{ url('things:create_motive') }}" class="btn btn-primary">Add more Things!</a>
{% endif %}
{% endblock %}
